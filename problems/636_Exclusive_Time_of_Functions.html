<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>636_Exclusive_Time_of_Functions</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p><strong>636.  Exclusive Time of Functions</strong></p>
<p>Medium</p>
<p>On a  <strong>single-threaded</strong>  CPU, we execute a program containing  <code>n</code>  functions. Each function has a unique ID between  <code>0</code>  and  <code>n-1</code>.</p>
<p>Function calls are  <strong>stored in a  <a href="https://en.wikipedia.org/wiki/Call_stack">call stack</a></strong>: when a function call starts, its ID is pushed onto the stack, and when a function call ends, its ID is popped off the stack. The function whose ID is at the top of the stack is  <strong>the current function being executed</strong>. Each time a function starts or ends, we write a log with the ID, whether it started or ended, and the timestamp.</p>
<p>You are given a list  <code>logs</code>, where  <code>logs[i]</code>  represents the  <code>ith</code>  log message formatted as a string  <code>"{function_id}:{"start" | "end"}:{timestamp}"</code>. For example,  <code>"0:start:3"</code>  means a function call with function ID  <code>0</code>  <strong>started at the beginning</strong>  of timestamp  <code>3</code>, and  <code>"1:end:2"</code>  means a function call with function ID  <code>1</code>  <strong>ended at the end</strong>  of timestamp  <code>2</code>. Note that a function can be called  <strong>multiple times, possibly recursively</strong>.</p>
<p>A function’s  <strong>exclusive time</strong>  is the sum of execution times for all function calls in the program. For example, if a function is called twice, one call executing for  <code>2</code>  time units and another call executing for  <code>1</code>  time unit, the  <strong>exclusive time</strong>  is  <code>2 + 1 = 3</code>.</p>
<p>Return  <em>the  <strong>exclusive time</strong>  of each function in an array, where the value at the</em> <code>ith</code> <em>index represents the exclusive time for the function with ID</em> <code>i</code>.</p>
<p><strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2019/04/05/diag1b.png" alt=""></p>
<p><strong>Input:</strong> n = 2, logs = [“0:start:0”,“1:start:2”,“1🔚5”,“0🔚6”]<br>
<strong>Output:</strong> [3,4]<br>
<strong>Explanation:</strong><br>
Function 0 starts at the beginning of time 0, then it executes 2 for units of time and reaches the end of time 1.<br>
Function 1 starts at the beginning of time 2, executes for 4 units of time, and ends at the end of time 5.<br>
Function 0 resumes execution at the beginning of time 6 and executes for 1 unit of time.<br>
So function 0 spends 2 + 1 = 3 units of total time executing, and function 1 spends 4 units of total time executing.</p>
<p><strong>Example 2:</strong></p>
<p><strong>Input:</strong> n = 1, logs = [“0:start:0”,“0:start:2”,“0🔚5”,“0:start:6”,“0🔚6”,“0🔚7”]<br>
<strong>Output:</strong> [8]<br>
<strong>Explanation:</strong><br>
Function 0 starts at the beginning of time 0, executes for 2 units of time, and recursively calls itself.<br>
Function 0 (recursive call) starts at the beginning of time 2 and executes for 4 units of time.<br>
Function 0 (initial call) resumes execution then immediately calls itself again.<br>
Function 0 (2nd recursive call) starts at the beginning of time 6 and executes for 1 unit of time.<br>
Function 0 (initial call) resumes execution at the beginning of time 7 and executes for 1 unit of time.<br>
So function 0 spends 2 + 4 + 1 + 1 = 8 units of total time executing.</p>
<p><strong>Example 3:</strong></p>
<p><strong>Input:</strong> n = 2, logs = [“0:start:0”,“0:start:2”,“0🔚5”,“1:start:6”,“1🔚6”,“0🔚7”]<br>
<strong>Output:</strong> [7,1]<br>
<strong>Explanation:</strong><br>
Function 0 starts at the beginning of time 0, executes for 2 units of time, and recursively calls itself.<br>
Function 0 (recursive call) starts at the beginning of time 2 and executes for 4 units of time.<br>
Function 0 (initial call) resumes execution then immediately calls function 1.<br>
Function 1 starts at the beginning of time 6, executes 1 units of time, and ends at the end of time 6.<br>
Function 0 resumes execution at the beginning of time 6 and executes for 2 units of time.<br>
So function 0 spends 2 + 4 + 1 = 7 units of total time executing, and function 1 spends 1 unit of total time executing.</p>
<p><strong>Example 4:</strong></p>
<p><strong>Input:</strong> n = 2, logs = [“0:start:0”,“0:start:2”,“0🔚5”,“1:start:7”,“1🔚7”,“0🔚8”]<br>
<strong>Output:</strong> [8,1]</p>
<p><strong>Example 5:</strong></p>
<p><strong>Input:</strong> n = 1, logs = [“0:start:0”,“0🔚0”]<br>
<strong>Output:</strong> [1]</p>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= n &lt;= 100</code></li>
<li><code>1 &lt;= logs.length &lt;= 500</code></li>
<li><code>0 &lt;= function_id &lt; n</code></li>
<li><code>0 &lt;= timestamp &lt;= 109</code></li>
<li>No two start events will happen at the same timestamp.</li>
<li>No two end events will happen at the same timestamp.</li>
<li>Each function has an  <code>"end"</code>  log for each  <code>"start"</code>  log.</li>
</ul>
<p><strong>[Solution]</strong></p>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">exclusiveTime</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> logs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>logs <span class="token operator">==</span> null <span class="token operator">||</span> logs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        
        Stack<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>String log<span class="token operator">:</span> logs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            String<span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> log<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> id <span class="token operator">=</span> Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">boolean</span> start <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ts <span class="token operator">=</span> Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token keyword">if</span> <span class="token punctuation">(</span>start<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                   <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prev <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   res<span class="token punctuation">[</span>prev<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> ts <span class="token operator">-</span> prev<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                   prev<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> ts<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
               stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>id<span class="token punctuation">,</span> ts<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prev <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    res<span class="token punctuation">[</span>prev<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> ts <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> prev<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> ts <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div>
</body>

</html>
