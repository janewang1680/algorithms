<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>981_Time_Based_Key_Value_Store</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p><strong>981.  Time Based Key-Value Store</strong></p>
<p>Medium</p>
<p>Create a timebased key-value store class <code>TimeMap</code>, that supports two operations.</p>
<ol>
<li><code>set(string key, string value, int timestamp)</code></li>
</ol>
<ul>
<li>Stores the  <code>key</code>  and  <code>value</code>, along with the given  <code>timestamp</code>.</li>
</ul>
<ol start="2">
<li><code>get(string key, int timestamp)</code></li>
</ol>
<ul>
<li>Returns a value such that  <code>set(key, value, timestamp_prev)</code>  was called previously, with  <code>timestamp_prev &lt;= timestamp</code>.</li>
<li>If there are multiple such values, it returns the one with the largest  <code>timestamp_prev</code>.</li>
<li>If there are no values, it returns the empty string (<code>""</code>).</li>
</ul>
<p><strong>Example 1:</strong></p>
<p><strong>Input:</strong> inputs = [“TimeMap”,“set”,“get”,“get”,“set”,“get”,“get”], inputs = [[],[“foo”,“bar”,1],[“foo”,1],[“foo”,3],[“foo”,“bar2”,4],[“foo”,4],[“foo”,5]]<br>
<strong>Output:</strong> [null,null,“bar”,“bar”,null,“bar2”,“bar2”]<br>
**Explanation: **TimeMap kv;<br>
kv.set(“foo”, “bar”, 1); // store the key “foo” and value “bar” along with timestamp = 1<br>
kv.get(“foo”, 1);  // output “bar”<br>
kv.get(“foo”, 3); // output “bar” since there is no value corresponding to foo at timestamp 3 and timestamp 2, then the only value is at timestamp 1 ie “bar”<br>
kv.set(“foo”, “bar2”, 4);<br>
kv.get(“foo”, 4); // output “bar2”<br>
kv.get(“foo”, 5); //output “bar2”</p>
<p><strong>Example 2:</strong></p>
<p><strong>Input:</strong> inputs = [“TimeMap”,“set”,“set”,“get”,“get”,“get”,“get”,“get”], inputs = [[],[“love”,“high”,10],[“love”,“low”,20],[“love”,5],[“love”,10],[“love”,15],[“love”,20],[“love”,25]]<br>
<strong>Output:</strong> [null,null,null,"",“high”,“high”,“low”,“low”]</p>
<p><strong>Note:</strong></p>
<ol>
<li>All key/value strings are lowercase.</li>
<li>All key/value strings have length in the range <code>[1, 100]</code></li>
<li>The  <code>timestamps</code>  for all  <code>TimeMap.set</code>  operations are strictly increasing.</li>
<li><code>1 &lt;= timestamp &lt;= 10^7</code></li>
<li><code>TimeMap.set</code>  and  <code>TimeMap.get</code> functions will be called a total of  <code>120000</code>  times (combined) per test case.</li>
</ol>
<p><strong>[Solution]</strong></p>
<pre class=" language-java"><code class="prism  language-java"><span class="token keyword">class</span> <span class="token class-name">TimeMap</span> <span class="token punctuation">{</span>
    Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> TreeMap<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> String<span class="token operator">&gt;&gt;</span> map<span class="token punctuation">;</span>
    <span class="token comment">/** Initialize your data structure here. */</span>
    <span class="token keyword">public</span> <span class="token function">TimeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> String value<span class="token punctuation">,</span> <span class="token keyword">int</span> timestamp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> z<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> String <span class="token function">get</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> <span class="token keyword">int</span> timestamp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Integer ts <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">floorKey</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ts <span class="token operator">==</span> null <span class="token operator">?</span> <span class="token string">""</span><span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ts<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div>
</body>

</html>
